(function(e){function a(){var a=u[d];0==d&&e(".gil-update-wrapper").fadeIn(l).css("display","table"),a&&(t(a),s(a),d++)}function t(t){if(t&&t.action){var s={action:t.action};t.parameters&&"object"==typeof t.parameters&&s.push(t.parameters),e.ajax({url:ajaxurl,method:"POST",data:s,success:function(t){console.log(t),t.success?(a(),t.date&&t.string_date&&(e(".time-ago").data("timeago",null).attr("datetime",t.date).text(t.string_date).timeago(),e(".update").attr("diff",0),n()),t.size&&e(".gil-size").text(t.size)):r(t.exception)}})}return!1}function s(a){e(a.class).siblings(":visible").length>0?e(a.class).siblings(":visible").css("transform","translate3d(0, "+p+", 0)").fadeOut(c,function(){a.finish&&e(".gil-update-wrapper .animation").fadeOut(c/2).css("transform","translate3d(0, -"+p+", 0)"),e(a.class).fadeIn(c).css("transform","translate3d(0, 0px, 0)")}):(a.finish&&e(".gil-update-wrapper .animation").fadeOut(c/2).css("transform","translate3d(0, -"+p+", 0)"),e(a.class).fadeIn(c).css("transform","translate3d(0, 0px, 0)"))}function i(){d=0,e(".gil-update-wrapper .animation, .gil-update-wrapper .process > div, .bookshelf_wrapper").removeAttr("style"),e(".bookshelf_wrapper").removeClass("paused")}function r(a){e(".bookshelf_wrapper").addClass("paused"),e(".process .failure").siblings(":visible").css("transform","translate3d(0, "+p+", 0)").fadeOut(c,function(){console.log(f[a]),e(".process .failure .exception").text(f[a]),e(".process .failure").fadeIn(c).css("transform","translate3d(0, 0px, 0)")})}function n(){var t=e(".update").attr("diff");if(""==t||t>=o)e(".update").on("click",function(){return a()});else{var s=o-t,i=1==s?"HOUR":"HOURS";e(".update").hide().after('<span class="remain">[ UPDATE AVAILABLE IN '+s+" "+i+" ]</span>")}}var o=72,l=250,c=400,p="40px",d=0,u=[{action:"geo_ip_get_library",class:".downloading"},{action:"geo_ip_extract_library",class:".decompressing"},{action:"geo_ip_update_latest",class:".done",finish:!0}],f={FILE_DOWNLOAD:"Something went wrong while attempting to download from source. Try again later.",FILE_SIZE:"It seems that source library is updating itself, give it a try later.",FILE_EXTRACTION:"There was something weird while trying to unzip the source file. Try again in a few minutes.",FILE_NOT_FOUND:"Huh! The library source was suppose to be found, but is not! Check for writing and reading permissions and try it again."};e(document).ready(function(){n(),"Never"!=e(".time-ago").text()&&e(".time-ago").timeago(),e(".gil-close").on("click",function(){return e(".gil-update-wrapper").fadeOut(l,function(){i()}),!1})})})(jQuery);